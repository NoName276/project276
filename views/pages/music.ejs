<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>The Club</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
    <style>
      body{
        background-image: url("/homeimage.png");
      }
      input, button, #tokenid{
        width: 80%;
        margin-top: 2%;
        background-color: black;
        color: white;
        padding: 1% 1%;
        border-radius: 0px;
        border: 0px;
        font-size: 16px;
        font-family: 'Press Start 2P', cursive;
        cursor: pointer;
        transition-duration: 0.4s;
      }
      button:hover, input:hover{
        color: blue;
      }
    </style>
  </head>
  <body>
      <a href="/spotify-login">
          <button id = "loginButton">Login With Spotify</button>
      </a>
      <p id="token"></p>
      <button id = "getToken">Step 2. Click here for Access Token</button>
      <form class="" action="/playing" method="post">
        <input id ="tokenid" type="text" name="tokenName" placeholder="Click Get Access Token" readonly required>
        <input id ="getPlaying" type="submit" name="" value="Get Now Playing">
      </form>

      <script>
        function getHashParams() {
            var hashParams = {};
            var e, r = /([^&;=]+)=?([^&;]*)/g,
                q = window.location.hash.substring(1);
            while ( e = r.exec(q)) {
             hashParams[e[1]] = decodeURIComponent(e[2]);
            }
            return hashParams;
        }
        document.getElementById("getToken").addEventListener('click', function() {
          var params = getHashParams();
          console.log(params.access_token);
          // console.log(params)
          if (typeof params.access_token === 'undefined') {
            document.getElementById("token").innerHTML = "Please login to Spotify first";
          } else {
            // document.getElementById("token").innerHTML = params.access_token;
            document.getElementById("tokenid").value = params.access_token;
          }
        })

      </script>


  </body>
</html>

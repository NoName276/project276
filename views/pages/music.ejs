<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <style>
      #tokenid {
        width: 50%;
      }
    </style>
  </head>
  <body>
      <a href="/spotify-login">
          <button>Login With Spotify</button>
      </a>
      <button id = "getToken">Get Access Token</button>

      <p id = "token"></p>

      <form class="" action="/playing" method="post">
        <input id ="tokenid" type="text" name="tokenName" placeholder="Click Get Access Token" readonly required>
        <input type="submit" name="" value="Get Now Playing">
      </form>
      
      <script>
        function getHashParams() {
            var hashParams = {};
            var e, r = /([^&;=]+)=?([^&;]*)/g,
                q = window.location.hash.substring(1);
            while ( e = r.exec(q)) {
             hashParams[e[1]] = decodeURIComponent(e[2]);
            }
            return hashParams;
        }
        document.getElementById("getToken").addEventListener('click', function() {
          var params = getHashParams();
          console.log(params.access_token);
          // console.log(params)
          if (typeof params.access_token === 'undefined') {
            document.getElementById("token").innerHTML = "Please login to Spotify first";
          } else {
            // document.getElementById("token").innerHTML = params.access_token;
            document.getElementById("tokenid").value = params.access_token;
          }
        })
    
      </script>


  </body>
</html>